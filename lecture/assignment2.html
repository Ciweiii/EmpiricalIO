<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Assignment 2: Production Function Estimation | A2-assignment.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Assignment 2: Production Function Estimation | A2-assignment.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Assignment 2: Production Function Estimation | A2-assignment.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON5630</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#assignment2"><i class="fa fa-check"></i><b>1</b> Assignment 2: Production Function Estimation</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#simulate-data"><i class="fa fa-check"></i><b>1.1</b> Simulate data</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#estimate-the-parameters"><i class="fa fa-check"></i><b>1.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="assignment2" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Assignment 2: Production Function Estimation<a href="#assignment2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simulate-data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Simulate data<a href="#simulate-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the following production and investment process for <span class="math inline">\(j = 1, \cdots, 1000\)</span> firms across <span class="math inline">\(t = 1, \cdots, 10\)</span> periods.</p>
<p>The log production function is of the form:
<span class="math display">\[
y_{jt} = \beta_0 + \beta_l l_{jt} + \beta_k k_{jt} + \omega_{jt} + \eta_{jt},
\]</span>
where <span class="math inline">\(\omega_{jt}\)</span> is an anticipated shock and <span class="math inline">\(\eta_{jt}\)</span> is an ex post shock.</p>
<p>The anticipated shocks evolve as:
<span class="math display">\[
\omega_{jt} = \alpha \omega_{j, t - 1} + \nu_{jt},
\]</span>
where <span class="math inline">\(\nu_{jt}\)</span> is an i.i.d. normal random variable with mean 0 and standard deviation <span class="math inline">\(\sigma_\nu\)</span>. The ex post shock is an i.i.d. normal random variable with mean 0 and standard deviation <span class="math inline">\(\sigma_{\eta}\)</span>.</p>
<p>The product price the same across firms and normalized at 1. The price is normalized at 1. The wage <span class="math inline">\(w_t\)</span> is constant at 0.5.</p>
<p>Finally, the capital accumulate according to:
<span class="math display">\[
K_{j, t + 1} = (1 - \delta) K_{jt} + I_{jt}.
\]</span></p>
<p>We set the parameters as follows:</p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>variable</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="math inline">\(\beta_0\)</span></td>
<td><code>beta_0</code></td>
<td>1</td>
</tr>
<tr>
<td><span class="math inline">\(\beta_l\)</span></td>
<td><code>beta_l</code></td>
<td>0.2</td>
</tr>
<tr>
<td><span class="math inline">\(\beta_k\)</span></td>
<td><code>beta_k</code></td>
<td>0.7</td>
</tr>
<tr>
<td><span class="math inline">\(\alpha\)</span></td>
<td><code>alpha</code></td>
<td>0.7</td>
</tr>
<tr>
<td><span class="math inline">\(\sigma_{\eta}\)</span></td>
<td><code>sigma_eta</code></td>
<td>0.2</td>
</tr>
<tr>
<td><span class="math inline">\(\sigma_{\nu}\)</span></td>
<td><code>sigma_nu</code></td>
<td>0.5</td>
</tr>
<tr>
<td><span class="math inline">\(\sigma_{w}\)</span></td>
<td><code>sigma_w</code></td>
<td>0.1</td>
</tr>
<tr>
<td><span class="math inline">\(\delta\)</span></td>
<td><code>delta</code></td>
<td>0.05</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><p>Define the parameter variables as above.</p></li>
<li><p>Write a function that returns the log output given <span class="math inline">\(l_{jt}\)</span>, <span class="math inline">\(k_{jt}\)</span>, <span class="math inline">\(\omega_{jt}\)</span>, and <span class="math inline">\(\eta_{jt}\)</span> under the given parameter values according to the above production function and name it <code>log_production(l, k, omega, eta, beta_0, beta_l, beta_k)</code>.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">log_production</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="at">l =</span> <span class="dv">1</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">omega =</span> <span class="dv">1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">eta =</span> <span class="dv">1</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">beta_0 =</span> beta_0,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="at">beta_l =</span> beta_l,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="at">beta_k =</span> beta_k</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    ) </span></code></pre></div>
<pre><code>## [1] 3.9</code></pre>
<p>Suppose that the labor is determined after <span class="math inline">\(\omega_{jt}\)</span> is observed, but before <span class="math inline">\(\eta_{jt}\)</span> is observed, given the log capital level <span class="math inline">\(k_{jt}\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Derive the optimal log labor as a function of <span class="math inline">\(\omega_{jt}\)</span>, <span class="math inline">\(\eta_{jt}\)</span>, <span class="math inline">\(k_{jt}\)</span>, and wage. Write a function to return the optimal log labor given the variables and parameters and name it <code>log_labor_choice(k, wage, omega, beta_0, beta_l, beta_k, sigma_eta)</code>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">log_labor_choice</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">wage =</span> <span class="dv">1</span>, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">omega =</span> <span class="dv">1</span>, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">beta_0 =</span> beta_0, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">beta_l =</span> beta_l, </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">beta_k =</span> beta_k, </span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">sigma_eta =</span> sigma_eta</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## [1] 1.388203</code></pre>
<p>As discussed in the class, if there is no additional variation in labor, the coefficient on the labor <span class="math inline">\(\beta_l\)</span> is not identified. Thus, if we generate labor choice from the previous function, <span class="math inline">\(\beta_l\)</span> will not be identified from the simulated data. To see this, we write a modified version of the previous function in which <span class="math inline">\(\omega_{jt}\)</span> is replaced with <span class="math inline">\(\omega_{jt} + \iota_{jt}\)</span>, where <span class="math inline">\(\iota_{jt}\)</span> is an optimization error that follows an i.i.d. normal distribution with mean 0 and standard deviation 0.05. That is, the manager of the firm perceives as if the shock is <span class="math inline">\(\omega_{jt} + \iota_{jt}\)</span>, even though the true shock is <span class="math inline">\(\omega_{jt}\)</span>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Modify the previous function by including <span class="math inline">\(\iota_{jt}\)</span> as an additional input and name it <code>log_labor_choice_error(k, wage, omega, beta_0, beta_l, beta_k, iota, sigma_eta)</code>.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">log_labor_choice_error</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">wage =</span> <span class="dv">1</span>, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">omega =</span> <span class="dv">1</span>, </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">beta_0 =</span> beta_0, </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">beta_l =</span> beta_l, </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">beta_k =</span> beta_k, </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">iota =</span> <span class="dv">1</span>, </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">sigma_eta =</span> sigma_eta</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## [1] 2.638203</code></pre>
<p>Consider an investment process such that:
<span class="math display">\[
I_{jt} = (\delta + \gamma \omega_{jt}) K_{jt},
\]</span>
where <span class="math inline">\(I_{jt}\)</span> and <span class="math inline">\(K_{jt}\)</span> are investment and capital in level. Set <span class="math inline">\(\gamma = 0.1\)</span>, i.e., the investment is strictly increasing in <span class="math inline">\(\omega_{jt}\)</span>. The investment function should be derived by solving the dynamic problem of a firm. But here, we just specify it in a reduced-form.</p>
<ol start="5" style="list-style-type: decimal">
<li>Define variable <span class="math inline">\(\gamma\)</span> and assign it the value. Write a function that returns the investment given <span class="math inline">\(K_{jt}\)</span>, <span class="math inline">\(\omega_{jt}\)</span>, and parameter values, according to the previous equation, and name it <code>investment_choice(k, omega, gamma, delta)</code>.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">investment_choice</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">omega =</span> <span class="dv">1</span>, </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">gamma =</span> gamma, </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">delta =</span> delta</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## [1] 0.4077423</code></pre>
<p>Simulate the data first using the labor choice without optimization error and second using the labor choice with optimization error. To do so, we specify the initial values for the state variables <span class="math inline">\(k_{jt}\)</span> and <span class="math inline">\(\omega_{jt}\)</span> as follows.</p>
<ol start="6" style="list-style-type: decimal">
<li>Draw <span class="math inline">\(k_{j1}\)</span> from an i.i.d. normal distribution with mean 1 and standard deviation 0.5. Draw <span class="math inline">\(\omega_{j1}\)</span> from its stationary distribution (check the stationary distribution of AR(1) process). Draw a wage. Before simulating the rest of the data, set the seed at 1.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 5
##        j     t     k   omega  wage
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 0.687  0.795    0.5
##  2     2     1 1.09   0.779    0.5
##  3     3     1 0.582 -0.610    0.5
##  4     4     1 1.80   0.148    0.5
##  5     5     1 1.16   0.0486   0.5
##  6     6     1 0.590 -1.16     0.5
##  7     7     1 1.24   0.568    0.5
##  8     8     1 1.37  -1.34     0.5
##  9     9     1 1.29  -0.873    0.5
## 10    10     1 0.847  0.699    0.5
## # ℹ 990 more rows</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Draw optimization error <span class="math inline">\(\iota_{jt}\)</span> and compute the labor and investment choice of period 1. For labor choice, compute both types of labor choices.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 9
##        j     t     k   omega  wage     iota      l l_error     inv
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1 0.687  0.795    0.5 -0.0443   1.72   1.67    0.257 
##  2     2     1 1.09   0.779    0.5 -0.0961   2.06   1.94    0.381 
##  3     3     1 0.582 -0.610    0.5  0.0810  -0.123 -0.0218 -0.0196
##  4     4     1 1.80   0.148    0.5  0.0260   1.89   1.92    0.391 
##  5     5     1 1.16   0.0486   0.5 -0.00279  1.21   1.21    0.176 
##  6     6     1 0.590 -1.16     0.5  0.0348  -0.809 -0.766  -0.120 
##  7     7     1 1.24   0.568    0.5  0.00268  1.93   1.93    0.370 
##  8     8     1 1.37  -1.34     0.5 -0.0655  -0.346 -0.428  -0.330 
##  9     9     1 1.29  -0.873    0.5 -0.106    0.165  0.0327 -0.135 
## 10    10     1 0.847  0.699    0.5 -0.0104   1.74   1.73    0.280 
## # ℹ 990 more rows</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Draw ex post shock and compute the output according to the production function for both labor without optimization error and with optimization error. Name the output without optimization error <code>y</code> and the one with optimization error <code>y_error</code>.</li>
</ol>
<pre><code>## # A tibble: 1,000 × 12
##        j     t     k   omega  wage     iota      l l_error     inv     eta     y
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 0.687  0.795    0.5 -0.0443   1.72   1.67    0.257   0.148  2.77 
##  2     2     1 1.09   0.779    0.5 -0.0961   2.06   1.94    0.381   0.0773 3.03 
##  3     3     1 0.582 -0.610    0.5  0.0810  -0.123 -0.0218 -0.0196  0.259  1.03 
##  4     4     1 1.80   0.148    0.5  0.0260   1.89   1.92    0.391  -0.161  2.62 
##  5     5     1 1.16   0.0486   0.5 -0.00279  1.21   1.21    0.176  -0.321  1.79 
##  6     6     1 0.590 -1.16     0.5  0.0348  -0.809 -0.766  -0.120   0.187  0.274
##  7     7     1 1.24   0.568    0.5  0.00268  1.93   1.93    0.370   0.361  3.19 
##  8     8     1 1.37  -1.34     0.5 -0.0655  -0.346 -0.428  -0.330  -0.0113 0.539
##  9     9     1 1.29  -0.873    0.5 -0.106    0.165  0.0327 -0.135   0.377  1.44 
## 10    10     1 0.847  0.699    0.5 -0.0104   1.74   1.73    0.280   0.316  2.96 
## # ℹ 990 more rows
## # ℹ 1 more variable: y_error &lt;dbl&gt;</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Repeat this procedure for <span class="math inline">\(t = 1, \cdots 10\)</span> by updating the capital and anticipated shocks, and name the resulting data frame <code>df_all</code>. Use the previously generated <code>df</code> as the data for <code>t = 1</code>. In each perio, generate <code>nu</code>, <code>iota</code>, and <code>eta</code> in this order, if you want to match the realization of the random variables.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_all</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 13
##        j     t     k   omega  wage     iota      l l_error     inv     eta     y
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 0.687  0.795    0.5 -0.0443   1.72   1.67    0.257   0.148  2.77 
##  2     2     1 1.09   0.779    0.5 -0.0961   2.06   1.94    0.381   0.0773 3.03 
##  3     3     1 0.582 -0.610    0.5  0.0810  -0.123 -0.0218 -0.0196  0.259  1.03 
##  4     4     1 1.80   0.148    0.5  0.0260   1.89   1.92    0.391  -0.161  2.62 
##  5     5     1 1.16   0.0486   0.5 -0.00279  1.21   1.21    0.176  -0.321  1.79 
##  6     6     1 0.590 -1.16     0.5  0.0348  -0.809 -0.766  -0.120   0.187  0.274
##  7     7     1 1.24   0.568    0.5  0.00268  1.93   1.93    0.370   0.361  3.19 
##  8     8     1 1.37  -1.34     0.5 -0.0655  -0.346 -0.428  -0.330  -0.0113 0.539
##  9     9     1 1.29  -0.873    0.5 -0.106    0.165  0.0327 -0.135   0.377  1.44 
## 10    10     1 0.847  0.699    0.5 -0.0104   1.74   1.73    0.280   0.316  2.96 
## # ℹ 9,990 more rows
## # ℹ 2 more variables: y_error &lt;dbl&gt;, nu &lt;dbl&gt;</code></pre>
<ol start="10" style="list-style-type: decimal">
<li>Check the simulated data by making summary table.</li>
</ol>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Sd</th>
<th align="right">Min</th>
<th align="right">Max</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">j</td>
<td align="right">10000</td>
<td align="right">500.5000000</td>
<td align="right">288.6894251</td>
<td align="right">1.0000000</td>
<td align="right">1000.0000000</td>
</tr>
<tr>
<td align="left">t</td>
<td align="right">10000</td>
<td align="right">5.5000000</td>
<td align="right">2.8724249</td>
<td align="right">1.0000000</td>
<td align="right">10.0000000</td>
</tr>
<tr>
<td align="left">k</td>
<td align="right">10000</td>
<td align="right">0.9797900</td>
<td align="right">0.5838949</td>
<td align="right">-1.2822534</td>
<td align="right">3.2332312</td>
</tr>
<tr>
<td align="left">omega</td>
<td align="right">10000</td>
<td align="right">-0.0055826</td>
<td align="right">0.7025102</td>
<td align="right">-2.5894171</td>
<td align="right">2.6281307</td>
</tr>
<tr>
<td align="left">wage</td>
<td align="right">10000</td>
<td align="right">0.5000000</td>
<td align="right">0.0000000</td>
<td align="right">0.5000000</td>
<td align="right">0.5000000</td>
</tr>
<tr>
<td align="left">iota</td>
<td align="right">10000</td>
<td align="right">-0.0000696</td>
<td align="right">0.0502883</td>
<td align="right">-0.1841453</td>
<td align="right">0.1715419</td>
</tr>
<tr>
<td align="left">l</td>
<td align="right">10000</td>
<td align="right">0.9799746</td>
<td align="right">1.0965108</td>
<td align="right">-3.3281023</td>
<td align="right">4.9679634</td>
</tr>
<tr>
<td align="left">l_error</td>
<td align="right">10000</td>
<td align="right">0.9798876</td>
<td align="right">1.0971595</td>
<td align="right">-3.3765433</td>
<td align="right">4.9520674</td>
</tr>
<tr>
<td align="left">inv</td>
<td align="right">10000</td>
<td align="right">0.1793502</td>
<td align="right">0.3006526</td>
<td align="right">-1.2722627</td>
<td align="right">3.2975332</td>
</tr>
<tr>
<td align="left">eta</td>
<td align="right">10000</td>
<td align="right">0.0015825</td>
<td align="right">0.2001539</td>
<td align="right">-0.7650371</td>
<td align="right">0.7455922</td>
</tr>
<tr>
<td align="left">y</td>
<td align="right">10000</td>
<td align="right">1.8778479</td>
<td align="right">1.1171035</td>
<td align="right">-2.4680251</td>
<td align="right">6.1228291</td>
</tr>
<tr>
<td align="left">y_error</td>
<td align="right">10000</td>
<td align="right">1.8778305</td>
<td align="right">1.1169266</td>
<td align="right">-2.4777133</td>
<td align="right">6.1196499</td>
</tr>
<tr>
<td align="left">nu</td>
<td align="right">10000</td>
<td align="right">-0.0021155</td>
<td align="right">0.4984324</td>
<td align="right">-2.1513907</td>
<td align="right">1.8253882</td>
</tr>
</tbody>
</table>
</div>
<div id="estimate-the-parameters" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Estimate the parameters<a href="#estimate-the-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For now, use the labor choice with optimization error.</p>
<ol style="list-style-type: decimal">
<li>First, simply regress <span class="math inline">\(y_{jt}\)</span> on <span class="math inline">\(l_{jt}\)</span> and <span class="math inline">\(k_{jt}\)</span> using the least square method.</li>
</ol>
<pre><code>## 
## Call:
## lm(formula = y_error ~ l_error + k, data = df_all)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73002 -0.14117 -0.00071  0.13743  0.87983 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.892542   0.004058 219.966   &lt;2e-16 ***
## l_error     0.997913   0.002396 416.454   &lt;2e-16 ***
## k           0.007599   0.004503   1.688   0.0915 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2068 on 9997 degrees of freedom
## Multiple R-squared:  0.9657, Adjusted R-squared:  0.9657 
## F-statistic: 1.408e+05 on 2 and 9997 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Second, take within-transformation on <span class="math inline">\(y_{jt}\)</span>, <span class="math inline">\(l_{jt}\)</span>, and <span class="math inline">\(k_{jt}\)</span> and let <span class="math inline">\(\Delta y_{jt}\)</span>, <span class="math inline">\(\Delta l_{jt}\)</span>, and <span class="math inline">\(\Delta k_{jt}\)</span> denote them. Then, regress <span class="math inline">\(\Delta y_{jt}\)</span> on <span class="math inline">\(\Delta l_{jt}\)</span>, and <span class="math inline">\(\Delta k_{jt}\)</span> by the least squares method.</li>
</ol>
<pre><code>## 
## Call:
## lm(formula = dy_error ~ -1 + dl_error + dk, data = df_all_within)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.72450 -0.13285 -0.00244  0.12931  0.77657 
## 
## Coefficients:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## dl_error  0.9910916  0.0029548 335.413   &lt;2e-16 ***
## dk       -0.0009029  0.0127539  -0.071    0.944    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1961 on 9998 degrees of freedom
## Multiple R-squared:  0.9184, Adjusted R-squared:  0.9184 
## F-statistic: 5.629e+04 on 2 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Next, we attempt to estimate the parameters using Olley-Pakes method. Estimate the first-step model of Olley-Pakes method:
<span class="math display">\[
y_{jt} = \beta_1 l_{jt} + \phi(k_{jt}, I_{jt}) + \eta_{jt},
\]</span>
by approximating <span class="math inline">\(\phi_t\)</span> by a kernel function.</p>
<p>Remark that <span class="math inline">\(\phi\)</span> in general depends on observed and unobserved state variables. For this reason, in theory, <span class="math inline">\(\phi\)</span> should be estimated for each period. In this exercise, we assume <span class="math inline">\(\phi\)</span> is common across periods because we know that there is no unobserved state variables in the true data generating process. Moreover, we do not include <span class="math inline">\(w_t\)</span> because we know that it is time -invariant. Do not forget to consider them in the actual data analysis.</p>
<p>You can use <code>npplreg</code> function of <code>np</code> package to estimate a partially linear model with a multivariate kernel. You first use <code>npplregbw</code> to obtain the optimal band width and then use <code>npplreg</code> to estimate the model under the optimal bandwidth. The computation of the optimal bandwidth is time consuming.</p>
<ol start="3" style="list-style-type: decimal">
<li>Return the summary of the first stage estimation and plot the fitted values against the data points.</li>
</ol>
<pre><code>## Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 1 of 2 -Multistart 1 of 2 \Multistart 1 of 2 |Multistart 1 of 2 |Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /Multistart 2 of 2 -Multistart 2 of 2 |Multistart 2 of 2 |                   Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 1 of 2 -Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /Multistart 2 of 2 -Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /                   </code></pre>
<pre><code>## 
## Partially Linear Model
## Regression data: 10000 training points, in 3 variable(s)
## With 1 linear parametric regressor(s), 2 nonparametric regressor(s)
## 
##                     y(z)           
## Bandwidth(s): 0.07355058 0.01435558
## 
##                     x(z)           
## Bandwidth(s): 0.03908594 0.01191551
## 
##                   l_error
## Coefficient(s): 0.2493396
## 
## Kernel Regression Estimator: Local-Constant
## Bandwidth Type: Fixed
## 
## Residual standard error: 0.1934778
## R-squared: 0.9700706
## 
## Continuous Kernel Type: Second-Order Gaussian
## No. Continuous Explanatory Vars.: 2</code></pre>
<p><img src="A2-assignment_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Check that <span class="math inline">\(\beta_l\)</span> is not identified with the data without optimization error. Estimate the first stage model of Olley-Pakes with the labor choice without optimization error and report the result.</li>
</ol>
<pre><code>## Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 1 of 2 -Multistart 1 of 2 \Multistart 1 of 2 |Multistart 1 of 2 |Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /Multistart 2 of 2 -Multistart 2 of 2 |Multistart 2 of 2 |                   Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 1 of 2 -Multistart 1 of 2 \Multistart 1 of 2 |Multistart 1 of 2 |Multistart 1 of 2 /Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /Multistart 2 of 2 -Multistart 2 of 2 \Multistart 2 of 2 |Multistart 2 of 2 |Multistart 2 of 2 /Multistart 2 of 2 -                   </code></pre>
<pre><code>## 
## Partially Linear Model
## Regression data: 10000 training points, in 3 variable(s)
## With 1 linear parametric regressor(s), 2 nonparametric regressor(s)
## 
##                     y(z)           
## Bandwidth(s): 0.07347226 0.01437256
## 
##                     x(z)            
## Bandwidth(s): 0.02960262 0.009987366
## 
##                        l
## Coefficient(s): 1.187301
## 
## Kernel Regression Estimator: Local-Constant
## Bandwidth Type: Fixed
## 
## Residual standard error: 0.1932366
## R-squared: 0.9701184
## 
## Continuous Kernel Type: Second-Order Gaussian
## No. Continuous Explanatory Vars.: 2</code></pre>
<p>Then, we estimate the second stage model of Olley-Pakes method:
<span class="math display">\[
y_{jt} - \hat{\beta_l} l_{jt} = \beta_0 + \beta_k k_{jt} + \alpha[\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}) - \beta_0 - \beta_k k_{j, t-1}] + \nu_{jt} + \eta_{jt}.
\]</span></p>
<p>In this model, we do not have to non-parametetrically estimate the conditional expectation of <span class="math inline">\(\omega_{jt}\)</span> on <span class="math inline">\(\omega_{j, t - 1}\)</span>, because we know that the anticipated shock follows an AR(1) process. Remark that we in general have to non-parametrically estimate it.</p>
<p>The model is non-linear in parameters, because of the term <span class="math inline">\(\alpha \beta_0\)</span> and <span class="math inline">\(\alpha \beta_k\)</span>. We estimate <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_k\)</span> by a GMM estimator. The moment is:
<span class="math display">\[
g_{JT}(\alpha, \beta_0, \beta_k) \equiv \frac{1}{JT}\sum_{j = 1}^J \sum_{t = 1}^T \{y_{jt} - \hat{\beta_l} l_{jt} - \beta_0 - \beta_k k_{jt} - \alpha[\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}) - \beta_0 - \beta_k k_{j, t-1}]\}
\begin{bmatrix}
k_{jt} \\
k_{j, t - 1} \\
I_{j, t - 1}
\end{bmatrix}.
\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Using the estimates in the first step, compute:
<span class="math display">\[
y_{jt} - \hat{\beta_l} l_{jt},
\]</span>
and:
<span class="math display">\[
\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}),
\]</span>
for each <span class="math inline">\(j\)</span> and <span class="math inline">\(t\)</span> and save it as a data frame names <code>df_all_1st</code>.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df_all_1st</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 4
##        j     t y_error_tilde phi_t_1
##    &lt;int&gt; &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1         2.34   NA    
##  2     1     2         1.37    2.21 
##  3     1     3         0.621   1.49 
##  4     1     4         0.447   0.880
##  5     1     5         0.878   0.611
##  6     1     6         1.62    0.926
##  7     1     7         0.558   1.40 
##  8     1     8         0.684   0.439
##  9     1     9         0.939   0.525
## 10     1    10         1.49    0.838
## # ℹ 9,990 more rows</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Compute a function that returns the value of <span class="math inline">\(g_{JT}(\alpha, \beta_0, \beta_k)\)</span> given parameter values, data, and <code>df_all_1st</code>, and name it <code>moment_olleypakes_2nd</code>. Show the values of the moments evaluated at the true parameters.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">moment_olleypakes_2nd</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="at">alpha =</span> alpha, </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="at">beta_0 =</span> beta_0, </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="at">beta_k =</span> beta_k, </span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="at">df_all =</span> df_all, </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="at">df_all_1st =</span> df_all_1st</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## [1] -0.018459481 -0.019010969 -0.003815687</code></pre>
<p>Based on the moment, we can define the objective function of a generalized method of moments estimator with a weighting matrix <span class="math inline">\(W\)</span> as:
<span class="math display">\[
Q_{JT}(\alpha, \beta_0, \beta_k) \equiv g_{JT}(\alpha, \beta_0, \beta_k)&#39; W g_{JT}(\alpha, \beta_0, \beta_k).
\]</span></p>
<ol start="7" style="list-style-type: decimal">
<li>Write a function that returns the value of <span class="math inline">\(Q_{JT}(\alpha, \beta_0, \beta_k)\)</span> given the vector of parameter values, data, and <code>df_all_1st</code>, and name it <code>objective_olleypakes_2nd</code>. Setting <span class="math inline">\(W\)</span> at the identity matrix, show the value of the objective function evaluated at the true parameters.</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> </span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    alpha, </span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    beta_0, </span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    beta_k</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    )</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="fu">objective_olleypakes_2nd</span>(</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="at">theta =</span> theta, </span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  <span class="at">df_all =</span> df_all, </span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  <span class="at">df_all_1st =</span> df_all_1st,</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  <span class="at">W =</span> W</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 0.0007167288</code></pre>
<ol start="8" style="list-style-type: decimal">
<li><p>Draw the graph of the objective function when one of <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_k\)</span> are changed from 0 to 1 by 0.1 while the others are set at the true value. Is the objective function minimized at around the true value?
<img src="A2-assignment_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /><img src="A2-assignment_files/figure-html/unnamed-chunk-28-2.png" width="672" style="display: block; margin: auto;" /><img src="A2-assignment_files/figure-html/unnamed-chunk-28-3.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Find the parameters that minimize the objective function using <code>optim</code>. You may use <code>L-BFGS-B</code> method to solve it.</p></li>
</ol>
<pre><code>## $par
## [1] 0.7023647 0.9766275 0.6694232
## 
## $value
## [1] 2.027934e-07
## 
## $counts
## function gradient 
##       10       10 
## 
## $convergence
## [1] 0
## 
## $message
## [1] &quot;CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH&quot;</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
